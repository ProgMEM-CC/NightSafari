name: A. COMPILE_NightSafari iOS

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build:
    name: COMPILE_NightSafari iOS
    runs-on: macos-latest

    steps:
      # Step 1: Checkout repository
      - name: Checkout repository
        uses: actions/checkout@v3

      # Step 2: Set up the latest Xcode version (e.g., Xcode 15.4)
      - name: Set up Xcode 15.4
        run: |
          sudo xcode-select --switch /Applications/Xcode_15.4.app/Contents/Developer
          xcodebuild -version

      # Step 3: Pull in project dependencies
      - name: Checkout dependencies
        run: ./checkout.sh

      # Step 4: Build project using Xcode project file
      - name: Build project in Xcode
        run: |
          cd focus-ios
          xcodebuild -project Blockzilla.xcodeproj \
                     -scheme Focus \
                     -sdk iphoneos \
                     -configuration Release \
                     -allowProvisioningUpdates \
                     -quiet

      # Optional: Run tests (if needed)
      # - name: Run tests
      #   run: |
      #     cd focus-ios
      #     xcodebuild test -project Blockzilla.xcodeproj \
      #                     -scheme Focus \
      #                     -sdk iphonesimulator \
      #                     -destination 'platform=iOS Simulator,name=iPhone 14,OS=latest'
